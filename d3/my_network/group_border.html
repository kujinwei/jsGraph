<html>

<script src="../lib/d3.min.js"></script>
<script src="../lib/innersvg.js"></script>

<svg width="500" height="500">
<g id="g1">
    <rect class="bounding-rect"></rect>

</g>
</svg>

<script>
    function updateRect() {
// SELECT ALL CHILD NODES EXCEPT THE BOUNDING RECT
        theGroup = d3.select('#g1') ;
        var allChildNodes = theGroup.selectAll(':not(.bounding-rect)')[0] ;

        console.log("allChildNodes=" , allChildNodes) ;

// `x` AND `y` ARE SIMPLY THE MIN VALUES OF ALL CHILD BBOXES
//        var x = d3.min(allChildNodes, function (d) {
//                    return d.getBBox().x;
//                }),
//                y = d3.min(allChildNodes, function (d) {
//                    return d.getBBox().y;
//                }),
//
//// WIDTH AND HEIGHT REQUIRE A BIT OF CALCULATION
//                width = d3.max(allChildNodes, function (d) {
//                    var bb = d.getBBox();
//                    return (bb.x + bb.width) - x;
//                }),
//
//                height = d3.max(allChildNodes, function (d) {
//                    var bb = d.getBBox();
//                    return (bb.y + bb.height) - y;
//                });

// UPDATE THE ATTRS FOR THE RECT
        var svg = d3.select('svg') ;


//        svg.select('.bounding-rect')
//                .attr('x', x)
//                .attr('y', y)
//                .attr('width', width)
//                .attr('height', height);
    }

    d3.select('#g1').append('circle')
            .attr('cx' , 200)
            .attr('cy' , 200)
            .attr('r' , 10) ;

    updateRect() ;

//    var bar = chart.selectAll("g")
//            .data(data)
//            .enter().append("g")
//            .attr("transform", function(d, i) { return "translate(0," + i * barHeight + ")"; });
//
//    bar.append("rect")
//            .attr("width", x)
//            .attr("height", barHeight - 1);
//
//    bar.append("text")
//            .attr("x", function(d) { return x(d) - 3; })
//            .attr("y", barHeight / 2)
//            .attr("dy", ".35em")
//            .text(function(d) { return d; });

</script>

</html>